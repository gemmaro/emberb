# SOME DESCRIPTIVE TITLE
# Copyright (C) YEAR Free Software Foundation, Inc.
# This file is distributed under the same license as the PACKAGE package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"POT-Creation-Date: 2022-02-10 09:07+0900\n"
"PO-Revision-Date: 2022-02-11 00:22+0900\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"Language: \n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:1
#, no-wrap
msgid "---\n"
msgstr "---\n"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:4
#, no-wrap
msgid ""
"layout: chapter\n"
"title: Running C in Ruby\n"
"---\n"
msgstr ""
"layout: chapter\n"
"title: RubyでC言語を実行する\n"
"---\n"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:7
msgid "## Compiling ##"
msgstr "## コンパイル"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:11
msgid ""
"Compiling C code to be loaded as a Ruby extension requires some fancy "
"compiler options. Ruby's [`mkmf` stdlib][mkmf] makes it easy to do this by "
"generating an appropriate makefile for you."
msgstr ""
"C言語のコードを、Rubyの拡張としてロードできるようにコンパイルするには、\n"
"ちょっとしたコンパイラのオプションが要ります。\n"
"Rubyの [`mkmf` 標準ライブラリ][mkmf]があれば、\n"
"適切なmakefileを生成してくれるので、\n"
"コンパイルが楽になります。"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:13
msgid "### Preparation ###"
msgstr "### 準備"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:15
msgid "First create the file `extconf.rb` in the same directory as your C code:"
msgstr "まず、C言語のコードがあるのと同じディレクトリに `extconf.rb` というファイルをつくります："

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:19
msgid "{% highlight ruby %} {% include extend/ext/extconf.rb %} {% endhighlight %}"
msgstr ""
"{% highlight ruby %}\n"
"{% include extend/ext/extconf.rb %}\n"
"{% endhighlight %}"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:22
msgid ""
"The preparation section should perform actions similar to the standard UNIX "
"[`configure` script][conf] e.g."
msgstr ""
"準備する部分では、標準的なUNIXでの [`configure` スクリプト][conf]でするようなことをします。\n"
"例えば："

#. type: Bullet: '* '
#: _posts/2013-01-01-extend.markdown:26
#, markdown-text
msgid "Check features of the current platform"
msgstr "現在のプラットフォームの特徴を確認する"

#. type: Bullet: '* '
#: _posts/2013-01-01-extend.markdown:26
#, markdown-text
msgid "Check for existence of required libraries and functions"
msgstr "必要なライブラリと関数があることを確認する"

#. type: Bullet: '* '
#: _posts/2013-01-01-extend.markdown:26
#, markdown-text
msgid "Check for programs needed for building"
msgstr "ビルドするのに必要なプログラムがあることを確認する"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:28
msgid "[conf]: http://en.wikipedia.org/wiki/Configure_script"
msgstr "[conf]: http://en.wikipedia.org/wiki/Configure_script"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:32
msgid ""
"The most common of these actions are provided by `mkmf` (but you have all of "
"Ruby at your disposal if you need it). For example, an extension which uses "
"SDL2 and needs to know how big `int`s are might call:"
msgstr ""
"あるあるな機能は `mkmf` で提供されます（でも、必要とあらばRubyをまったく使わなくてもいいです）。\n"
"例えば、SDL2を使っていて、それとは別に `int` の大きさを知らなければいけないような拡張であれば、\n"
"こんな感じで呼び出すことになります："

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:36
msgid "{% highlight ruby %} {% include extend/ext/exex.rb %} {% endhighlight %}"
msgstr ""
"{% highlight ruby %}\n"
"{% include extend/ext/exex.rb %}\n"
"{% endhighlight %}"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:40
msgid ""
"`create_header` creates the file `extconf.h` containing preprocessor "
"definitions based on the results of the `mkmf` functions you called "
"previously. For this example, `extconf.h` might contain"
msgstr ""
"`create_header` は、それより前に呼んだ `mkmf` の関数の結果に基づいて、\n"
"前処理器の定義を含む `extconf.h` ファイルをつくります。\n"
"この例では `extconf.h` は次のような内容を含みます："

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:44
msgid "{% highlight c %} {% include extend/ext/exh.h %} {% endhighlight %}"
msgstr ""
"{% highlight c %}\n"
"{% include extend/ext/exh.h %}\n"
"{% endhighlight %}"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:52
msgid ""
"This header should be included in your C files so that you can adapt your "
"code to a variety of platforms. Note that you can and should abort the "
"`extconf.rb` script if a `mkmf` function returns a value that indicates that "
"the build will fail. For example, if SDL2 is a _requirement_ of your "
"extension you should exit with some meaningful error message if "
"`have_library('SDL2')` returns `false`.  This is preferred to generating the "
"Makefile anyway and leaving the user with an opaque compiler error."
msgstr ""
"このヘッダはC言語のファイルに取り込むとよいでしょう。\n"
"そうすれば様々なプラットフォームでコードが使えるようになります。\n"
"気に留めておいてほしいことは、\n"
"`mkmf` 関数がビルドの失敗を示す値を返したら、\n"
"`extconf.rb` スクリプトを頓挫させられますし、そうするべきだということです。\n"
"例えば、ある拡張にSDL2が _必須_ であれば、\n"
"`have_library('SDL2')` が `false` を返したときは、\n"
"何らかの有意味なエラーメッセージを吐いて終了するようなスクリプトにしましょう。\n"
"とりあえずMakefileを生成して、\n"
"よくわからないコンパイルエラーで利用者を置き去りにするよりはマシです。"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:57
msgid ""
"`create_makefile` obviously creates the Makefile, but its argument is "
"especially important: it defines the entry point of your C code, the name of "
"the compiled library, and thus the argument for `require` in Ruby! This "
"should be the name of your extension."
msgstr ""
"`create_makefile` はもちろんMakefileをつくりますが、\n"
"その引数が特に大切です：\n"
"C言語のコードの入口を決めるものであり、\n"
"コンパイルされたライブラリの名前であり、\n"
"Rubyで `require` するときの引数でもあるのです！\n"
"これは拡張の名前であるべきです。"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:63
msgid ""
"You can modify a few of the generated Makefile variables by modifying the "
"corresponding globals in Ruby: `$CFLAGS`, `$CPPFLAGS`, and "
"`$LDFLAGS`[^glob].  You can also use the `$objs` global to define a list of "
"object files for the Makefile if its method of automatically generating "
"targets doesn't work for your extension."
msgstr ""
"生成されるMakefileの変数のいくつかを変更するには、\n"
"Rubyでの対応する大域変数を変更します：\n"
"`$CFLAGS` や `$CPPFLAGS` や `$LDFLAGS` がそうです。\n"
"自動的な生成方法がうまくいかないときは、\n"
"Makefileでのオブジェクトファイルのリストを `$objs` 大域変数で指定することもできます。"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:68
msgid ""
"All of the `mkmf` functions and their options are well-documented "
"[online][mkmf]. In addition to the functions for generating `extconf.h`, "
"there are a variety of functions for handling different source file layouts, "
"different file dependencies, etc."
msgstr ""
"全ての `mkmf` 関数とそれぞれのオプションは[オンライン][mkmf]で充分に文書化されています。\n"
"`extconf.h` を生成する関数に加えて、\n"
"また違ったソースファイルの配置や依存関係を制御する様々な関数があります。"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:70
msgid "[mkmf]: http://www.ruby-doc.org/stdlib/libdoc/mkmf/rdoc/MakeMakefile.html"
msgstr "[mkmf]: http://www.ruby-doc.org/stdlib/libdoc/mkmf/rdoc/MakeMakefile.html"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:72
msgid "### Execution ###"
msgstr "### 実行"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:74
msgid "The rest couldn't be simpler"
msgstr "あとはもう、これ以上簡単になりようがありません"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:79
msgid "{% highlight shell_session %} $ ruby extconf.rb $ make {% endhighlight %}"
msgstr ""
"{% highlight shell_session %}\n"
"$ ruby extconf.rb\n"
"$ make\n"
"{% endhighlight %}"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:81
msgid "[^argv]But of course that won't do anything without some C code to compile."
msgstr ""
"[^argv]\n"
"もちろん、C言語のコードがコンパイルできないことには話が進まないですけどね。"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:83
msgid "## Init ##"
msgstr "## 初期化"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:89
msgid ""
"In your C code, you'll want to include `ruby.h` to access the API. Other "
"than that the only requirement is to define a function for the Ruby VM to "
"call when your library is `require`d. The name of the function is determined "
"by the argument you passed to `create_makefile` in `extconf.rb`. We used "
"\"foobar\" in our example, so we'll create `foobar.c` containing"
msgstr ""
"C言語のコードでは `ruby.h` を含めてAPIを使えるようにしたいのではないでしょうか。\n"
"その他には、 `require` したときにRubyの仮想機械がライブラリを呼べるように、\n"
"関数を定義するだけでよいです。\n"
"関数の名前は、 `extconf.rb` で `create_makefile` に渡した引数で決まります。\n"
"ここまでの例で `\"foobar\"` を使ってきたので、\n"
"次の内容の `foobar.c` ファイルをつくります："

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:93
msgid "{% highlight c %} {% include extend/ext/foobar.c %} {% endhighlight %}"
msgstr ""
"{% highlight c %}\n"
"{% include extend/ext/foobar.c %}\n"
"{% endhighlight %}"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:95
msgid "### Filenames ###"
msgstr "### ファイル名"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:101
msgid ""
"If your extension has only a single C file, you should name it after your "
"extension as we did above. If your extensions has multiple C files _do not_ "
"name any of them after your extension. This is because the Makefile may "
"generate a `.o` file named after your extension for the linking stage, which "
"would cause a conflict if you also have a `.c` file which compiles to that "
"filename."
msgstr ""
"拡張に1つのC言語のファイルだけしかないなら、\n"
"さっきやったように拡張の名前と同じファイル名にしましょう。\n"
"逆に複数のC言語のファイルからなる場合、\n"
"拡張に _同じ名前を使わない_ ようにしましょう。\n"
"リンクする段階でMakefileが拡張名と同じ `.o` ファイルを生成すると、\n"
"それと同じファイル名にコンパイルされる `.c` ファイルがある場合に衝突してしまうからです。"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:104
msgid ""
"Also avoid naming any files `conftest.c` as this file may be written to by "
"`mkmf`."
msgstr "また、 `conftest.c` というファイル名も、 `mkmf` によって書き込まれるかもしれないので避けます。"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:106
msgid "## Success ##"
msgstr "## 成功"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:111
msgid ""
"Now make should compile a `.so` (or some other library) file which you can "
"`require` in Ruby. You can fill in your `Init` function with plain C code, "
"but you'll probably want to go back and learn about the [C API](../c) to do "
"more interesting stuff."
msgstr ""
"これにて make で `.so` （またはその他のライブラリ）にコンパイルして、\n"
"Rubyで `require` できるようになりました。\n"
"純粋なC言語のコードで `Init` 関数を実装していくこともできますが、\n"
"たぶんいったん戻って、\n"
"もっと面白いことをするために [C API](../c.ja) を学ばれるのではないでしょうか。"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:113
msgid "## Gem ##"
msgstr "## Gem"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:118
msgid ""
"After you've got your extension working nicely, you may want to bundle it up "
"as an easily distributable Ruby gem. rubygems.org has a [detailed "
"guide][rbg] on creating gems, but as far as C extensions go you just need to "
"tell the spec about `extconf.rb`[^rbg]:"
msgstr ""
"いい感じに拡張が動くようになったら、\n"
"簡単に配布できるRubyのgemとしてまとめたいはずです。\n"
"rubygems.org にはgemをつくる上での[詳細なガイド][rbg]がありますが、\n"
"C拡張に関して言えば `extconf.rb` についてspecに記すだけでよいです[^rbg]："

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:122
msgid "{% highlight ruby %} {% include extend/foobar.gemspec %} {% endhighlight %}"
msgstr ""
"{% highlight ruby %}\n"
"{% include extend/foobar.gemspec %}\n"
"{% endhighlight %}"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:125
msgid ""
"If your gem includes multiple independent extensions, you can organize them "
"in subdirectories of `ext/` and pass all of the `extconf.rb`s to the spec."
msgstr ""
"gemが複数の拡張に依存していたら、\n"
"`ext/` のサブディレクトリにそれぞれ固めて、\n"
"specに各々の `extconf.rb` を記します。"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:127
msgid "[rbg]: http://guides.rubygems.org/make-your-own-gem/"
msgstr "[rbg]: http://guides.rubygems.org/make-your-own-gem/"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:129
msgid "## Footnotes ##"
msgstr "## 脚註"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:131
msgid "[^glob]: Check the [official documentation][globals]."
msgstr "[^glob]: [公式文書][globals]をご確認ください。"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:135
#, no-wrap
msgid ""
"[^argv]: The official documentation [hints][makefile] that `mkmf` parses "
"certain\n"
"         command line flags e.g.  `--vendor`. But I can't find this "
"documented\n"
"         anywhere.\n"
msgstr "[^argv]: 公式文書は、`--vendor` のようなコマンドライン引数を `mkmf` がパースできると [仄めかしている][makefile] ようです。でも、このことはどこにも文書化されていないように見えます。\n"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:137
msgid ""
"[^rbg]: "
"[http://guides.rubygems.org/gems-with-extensions/](http://guides.rubygems.org/gems-with-extensions/)"
msgstr "[^rbg]: [http://guides.rubygems.org/gems-with-extensions/](http://guides.rubygems.org/gems-with-extensions/)"

#. type: Plain text
#: _posts/2013-01-01-extend.markdown:139
msgid ""
"[globals]: "
"https://github.com/ruby/ruby/blob/master/doc/extension.rdoc#label-Prepare+extconf.rb "
"[makefile]: "
"https://github.com/ruby/ruby/blob/master/doc/extension.rdoc#label-Generate+Makefile"
msgstr ""
"[globals]: https://github.com/ruby/ruby/blob/master/doc/extension.rdoc#label-Prepare+extconf.rb\n"
"[makefile]: https://github.com/ruby/ruby/blob/master/doc/extension.rdoc#label-Generate+Makefile"
